# JC Habitat — configuration .htaccess adaptée au sous-dossier /JCHabitat

DirectoryIndex index.php

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Ton projet est dans un sous-dossier JCHabitat
    RewriteBase /JCHabitat

    # Si le fichier ou dossier demandé existe, on le sert directement
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ - [L]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Sinon, tout passe par index.php
    RewriteRule ^ index.php [L]
</IfModule>

<IfModule !mod_rewrite.c>
    DirectoryIndex index.php
    <IfModule mod_alias.c>
        RedirectMatch 307 ^/$ /JCHabitat/index.php/
    </IfModule>
</IfModule>

# Compression gzip
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Mise en cache
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType text/html "access plus 0 seconds"
    ExpiresDefault "access plus 2 days"
</IfModule>

# Sécurité : bloquer l’accès aux fichiers sensibles
<FilesMatch "(^\.|composer\.(json|lock)|package\.json|webpack\.config\.js|phpunit\.xml\.dist|\.env)">
    Require all denied
</FilesMatch>
