{% extends 'base.html.twig' %}

{% block title %}D√©tail du devis n¬∞{{ devis.numeroDevis }}
{% endblock %}

{% block body %}
	{% include "Admin/commun/_menu.html.twig" %}

	<div class="container mt-4">
		<h1 class="mb-4">D√©tail du devis</h1>
		<div class="row">
			<div class="col-md-4 d-flex">
				<div class="card mb-4 flex-fill">
					<div class="card-body">
						<h5 class="card-title">Informations du devis</h5>
						<p>
							<strong>Num√©ro :</strong>
							{{ devis.numeroDevis }}</p>
						<p>
							<strong>Date de cr√©ation :</strong>
							{{ devis.dateCreation|date('d/m/Y H:i') }}
                        </p>
						<p>
							<strong>Statut :</strong>
                            {% if devis.statut is same as "en_cours" %}
                                En cours
                            {% elseif devis.statut is same as "nouveau" %}
                                Nouveau
                            {% elseif devis.statut is same as "valid√©" %}
                                valid√©
                            {% else %}
                                Annul√©
                            {% endif %}
                        </p>
						<p>
							<strong>Montant total :</strong>
							{{ devis.montantTotal|number_format(2, ',', ' ') }}
							‚Ç¨</p>
					</div>
				</div>
			</div>

			<div class="col-md-4 d-flex">
				{% if client %}
					<div class="card mb-4 flex-fill">
						<div class="card-body">
							<h5 class="card-title">Informations client</h5>
							<p>
								<strong>Nom :</strong>
								{{ client.nom }}</p>
							<p>
								<strong>Pr√©nom :</strong>
								{{ client.prenom }}</p>
							<p>
								<strong>Email :</strong>
								{{ client.email }}</p>
							{% if client.telephone %}
								<p>
									<strong>T√©l√©phone :</strong>
									{{ client.telephone }}</p>
							{% endif %}
						</div>
					</div>
				{% endif %}
			</div>
			<div class="col-md-4 d-flex">
				{% if demande %}
					<div class="card mb-4 flex-fill">
						<div class="card-body">
							<h5 class="card-title">Infos sur la demande</h5>
							<p>
								<strong>Type de projet et Accessibilit√©:</strong>
								{{ demande.typeIntervention }} {{ demande.accessibilite }}
							</p>
						<p>
							<strong>Positionnement :</strong>
							{% if demande.position is same as "vertical_mural" %}
                                Vertical mural
                            {% elseif demande.position is same as "horizontal_mural" %}
                                Horizontal mural
                            {% else %}
                                Au sol
                            {% endif %}
						</p>
						<p>
							<strong>Capacit√© souhait√©e :</strong>
							{{ demande.capacite }}
						</p>
					</div>
				</div>
			{% endif %}
		</div>
		{% if demande %}
			<div class="card mb-4">
				<div class="card-body">
					<p>
						<strong>Date de la demande :</strong>
						{{ demande.datedemande|date('d/m/Y') }}
					</p>
				</div>
			</div>
		{% endif %}
	</div>


	<div class="card mb-4">
		<div class="card-body">
			<h5 class="card-title">D√©tails de la prestation</h5>
			<table class="table table-striped">
				<thead>
					<tr>
						<th>Description</th>
						<th>Quantit√©</th>
						<th>Prix unitaire (‚Ç¨)</th>
						<th>Sous-total (‚Ç¨)</th>
					</tr>
				</thead>
				<tbody>
					{% for ligne in devis.lignes ?? [] %}
						<tr>
							<td>
								<strong>{{ ligne.title }}</strong><br>
								{% if ligne.description %}
									<small class="text-muted" style="white-space: pre-line;">
										{{ ligne.description }}
									</small>
								{% endif %}
							</td>
							<td>{{ ligne.quantity }}</td>
							<td>{{ ligne.unitPrice|number_format(2, ',', ' ') }}</td>
							<td>{{ (ligne.quantity * ligne.unitPrice)|number_format(2, ',', ' ') }}</td>
						</tr>
					{% else %}
						<tr>
							<td colspan="4" class="text-center text-muted">Aucune ligne de prestation enregistr√©e.</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>

	<div class="text-end mt-4">
		<a href="{{ path('admin_devis_index') }}" class="btn btn-secondary">‚¨Ö Retour √† la liste</a>
		<a href="{{ path('admin_devis_pdf', {'id': devis.id}) }}"><button class="btn btn-primary">üìÑ T√©l√©charger en PDF</button></a>
		<button class="btn btn-success">‚úâÔ∏è Envoyer au client</button>
	</div>
</div>{% endblock %}
